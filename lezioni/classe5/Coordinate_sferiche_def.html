<!doctype html>
<html lang="it" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Le Coordinate Sferiche</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&amp;family=Source+Sans+3:wght@300;400;600;700&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap" rel="stylesheet">
  <style>
html, body { height: 100%; margin: 0; padding: 0; }
body { font-family: 'Source Sans 3', sans-serif; overflow: hidden; }

:root {
  --bg-color: #0a0e1a;
  --surface-color: #141a2e;
  --text-color: #e8eaf0;
  --primary-color: #4f8cff;
  --secondary-color: #2d3a5c;
}

.slide-container {
  background: var(--bg-color);
  color: var(--text-color);
  height: 100%;
  width: 100%;
  position: relative;
  overflow: hidden;
}

.slide-container:fullscreen {
  height: 100vh;
  width: 100vw;
}

.slide {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  opacity: 0;
  transform: translateX(60px);
  transition: opacity 0.6s ease, transform 0.6s ease;
  pointer-events: none;
  overflow-y: auto;
  padding: clamp(1rem, 3vw, 2rem) clamp(1rem, 4vw, 3rem);
  padding-bottom: 4.5rem;
  -webkit-overflow-scrolling: touch;
}

.slide.active {
  opacity: 1;
  transform: translateX(0);
  pointer-events: all;
}

.slide.exit-left {
  opacity: 0;
  transform: translateX(-60px);
}

h1.slide-title {
  font-family: 'Playfair Display', serif;
  font-weight: 900;
  font-size: clamp(1.4rem, 4vw, 3rem);
  background: linear-gradient(135deg, var(--primary-color), #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 0.5rem;
  line-height: 1.2;
}

h2.section-title {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  font-size: clamp(1rem, 2.5vw, 1.8rem);
  color: var(--primary-color);
  margin-bottom: 0.8rem;
}

.math-box {
  background: var(--surface-color);
  border-left: 3px solid var(--primary-color);
  border-radius: 0 8px 8px 0;
  padding: clamp(0.6rem, 1.5vw, 1rem) clamp(0.8rem, 2vw, 1.5rem);
  font-family: 'JetBrains Mono', monospace;
  font-size: clamp(0.75rem, 1.5vw, 1.1rem);
  margin: 0.6rem 0;
  position: relative;
  overflow: hidden;
}

.math-box::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: linear-gradient(135deg, rgba(79,140,255,0.05), transparent);
  pointer-events: none;
}

.r-color { color: #ff6b6b; font-weight: 700; }
.theta-color { color: #4facfe; font-weight: 700; }
.phi-color { color: #43e97b; font-weight: 700; }

canvas.viz-canvas {
  border-radius: 12px;
  background: radial-gradient(ellipse at center, #111827, #0a0e1a);
  display: block;
}

.nav-bar {
  position: absolute;
  bottom: 0;
  left: 0; right: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: clamp(0.5rem, 1.5vw, 0.8rem) clamp(0.75rem, 2vw, 2rem);
  background: linear-gradient(to top, var(--bg-color) 70%, transparent);
  z-index: 100;
  gap: 0.5rem;
}

.nav-btn {
  background: var(--secondary-color);
  color: var(--text-color);
  border: none;
  padding: clamp(0.35rem, 1vw, 0.5rem) clamp(0.6rem, 1.5vw, 1.2rem);
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Source Sans 3', sans-serif;
  font-weight: 600;
  font-size: clamp(0.75rem, 1.5vw, 0.9rem);
  transition: background 0.2s, transform 0.15s;
  white-space: nowrap;
  flex-shrink: 0;
}

.nav-btn:hover { background: var(--primary-color); transform: translateY(-1px); }
.nav-btn:active { transform: translateY(0); }
.nav-btn:disabled { opacity: 0.3; cursor: default; transform: none; }
.nav-btn:disabled:hover { background: var(--secondary-color); }

.progress-track {
  flex: 1;
  height: 4px;
  background: var(--secondary-color);
  border-radius: 2px;
  margin: 0 0.5rem;
  overflow: hidden;
  min-width: 40px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary-color), #a78bfa);
  border-radius: 2px;
  transition: width 0.5s ease;
}

.quiz-option {
  background: var(--surface-color);
  border: 2px solid var(--secondary-color);
  border-radius: 10px;
  padding: clamp(0.5rem, 1.2vw, 0.8rem) clamp(0.7rem, 1.5vw, 1.2rem);
  cursor: pointer;
  transition: all 0.25s;
  font-size: clamp(0.8rem, 1.3vw, 1rem);
  text-align: left;
}

.quiz-option:hover { border-color: var(--primary-color); background: rgba(79,140,255,0.1); }
.quiz-option.correct { border-color: #43e97b; background: rgba(67,233,123,0.15); }
.quiz-option.wrong { border-color: #ff6b6b; background: rgba(255,107,107,0.12); }

.surface-card {
  background: var(--surface-color);
  border-radius: 12px;
  padding: clamp(0.75rem, 2vw, 1.2rem);
  border: 1px solid rgba(79,140,255,0.15);
}

.tag-pill {
  display: inline-block;
  padding: 0.2rem 0.7rem;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 600;
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.anim-in { animation: fadeInUp 0.5s ease forwards; }
.anim-delay-1 { animation-delay: 0.15s; opacity: 0; }
.anim-delay-2 { animation-delay: 0.3s; opacity: 0; }
.anim-delay-3 { animation-delay: 0.45s; opacity: 0; }
.anim-delay-4 { animation-delay: 0.6s; opacity: 0; }

.concept-node {
  background: var(--surface-color);
  border: 1px solid var(--secondary-color);
  border-radius: 10px;
  padding: 0.6rem 1rem;
  font-size: clamp(0.75rem, 1.2vw, 0.85rem);
  text-align: center;
  transition: border-color 0.3s;
}
.concept-node:hover { border-color: var(--primary-color); }

.exercise-input {
  background: var(--surface-color);
  border: 2px solid var(--secondary-color);
  border-radius: 8px;
  padding: 0.5rem 0.8rem;
  color: var(--text-color);
  font-family: 'JetBrains Mono', monospace;
  font-size: clamp(0.85rem, 1.2vw, 0.95rem);
  outline: none;
  width: clamp(60px, 15vw, 80px);
  text-align: center;
  transition: border-color 0.3s;
}
.exercise-input:focus { border-color: var(--primary-color); }

.comparison-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: clamp(0.7rem, 1.2vw, 0.9rem);
}
.comparison-table th {
  background: var(--primary-color);
  color: #fff;
  padding: clamp(0.4rem, 1vw, 0.6rem) clamp(0.5rem, 1.2vw, 0.8rem);
  text-align: center;
  font-weight: 700;
}
.comparison-table th:first-child { border-radius: 8px 0 0 0; }
.comparison-table th:last-child { border-radius: 0 8px 0 0; }
.comparison-table td {
  background: var(--surface-color);
  padding: clamp(0.35rem, 0.8vw, 0.5rem) clamp(0.5rem, 1vw, 0.8rem);
  text-align: center;
  border-bottom: 1px solid var(--secondary-color);
}

.slide::-webkit-scrollbar { width: 4px; }
.slide::-webkit-scrollbar-track { background: transparent; }
.slide::-webkit-scrollbar-thumb { background: var(--secondary-color); border-radius: 2px; }

/* â”€â”€ Responsive layout utilities â”€â”€ */

/* Mobile: stack flex containers vertically */
@media (max-width: 600px) {
  .flex-responsive {
    flex-direction: column !important;
  }
  .flex-responsive > * {
    min-width: 0 !important;
    width: 100% !important;
  }
  canvas.viz-canvas {
    max-width: 100% !important;
    width: 100% !important;
    height: auto !important;
  }
  .nav-bar {
    flex-wrap: wrap;
    padding: 0.5rem 0.75rem;
    gap: 0.4rem;
  }
  .progress-track {
    order: 3;
    width: 100%;
    margin: 0;
    flex: none;
  }
  #slideCounter {
    order: 2;
  }
  .hide-mobile { display: none !important; }
}

/* Tablet */
@media (min-width: 601px) and (max-width: 1024px) {
  .flex-responsive {
    flex-wrap: wrap;
  }
  .flex-responsive > * {
    min-width: 240px;
  }
}

/* Large screens */
@media (min-width: 1200px) {
  .slide {
    padding: 2rem 4rem;
    padding-bottom: 5rem;
  }
}
</style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <main class="slide-container" id="app"><!-- SLIDE 1: Introduzione -->
   <section class="slide active" id="slide-0" aria-label="Introduzione">
    <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding-bottom:3rem;">
     <p class="anim-in" style="font-size:clamp(0.9rem,1.5vw,1.1rem); color:var(--primary-color); letter-spacing:0.15em; text-transform:uppercase; margin-bottom:0.5rem; font-weight:600;">Presentazione Interattiva</p>
     <h1 class="slide-title anim-in anim-delay-1" id="mainTitleEl" style="font-size:clamp(2.5rem,6vw,4.5rem); text-align:center;">Le Coordinate Sferiche</h1>
     <p class="anim-in anim-delay-2" id="subtitleEl" style="font-size:clamp(1rem,2vw,1.4rem); color:#a0aec0; margin-top:0.4rem; font-family:'Playfair Display',serif; font-style:italic;">Geometria dello Spazio Tridimensionale</p>
     <div class="anim-in anim-delay-3" style="margin-top:2.5rem; background:var(--surface-color); border-radius:16px; padding:1.5rem 2rem; max-width:520px; border:1px solid rgba(79,140,255,0.2);">
      <p style="font-size:clamp(1rem,1.8vw,1.25rem); color:#cbd5e1; line-height:1.6;">ğŸ’¡ <em>Â«Come descriviamo la posizione di un punto nello spazio?Â»</em></p>
     </div>
     <div class="anim-in anim-delay-4" style="margin-top:2rem; display:flex; gap:2rem; flex-wrap:wrap; justify-content:center;">
      <div style="text-align:center;">
       <div style="font-size:2rem; margin-bottom:0.3rem;">
        ğŸ“
       </div>
       <p style="font-size:0.85rem; color:#94a3b8;">Cartesiane<br><strong style="color:#e8eaf0;">(x, y, z)</strong></p>
      </div>
      <div style="font-size:2rem; align-self:center; color:var(--primary-color);">
       âŸ¶
      </div>
      <div style="text-align:center;">
       <div style="font-size:2rem; margin-bottom:0.3rem;">
        ğŸŒ
       </div>
       <p style="font-size:0.85rem; color:#94a3b8;">Sferiche<br><strong style="color:#e8eaf0;">(<span class="r-color">r</span>, <span class="theta-color">Î¸</span>, <span class="phi-color">Ï†</span>)</strong></p>
      </div>
     </div>
    </div>
   </section><!-- SLIDE 2: Cosa sono -->
   <section class="slide" id="slide-1" aria-label="Definizione">
    <h1 class="slide-title">Cosa sono le Coordinate Sferiche?</h1>
    <p style="color:#94a3b8; font-size:clamp(0.85rem,1.3vw,1rem); margin-bottom:1rem; max-width:700px;">Un sistema alternativo per localizzare un punto nello spazio 3D usando una <strong style="color:var(--text-color);">distanza</strong> e <strong style="color:var(--text-color);">due angoli</strong>.</p>
    <div class="flex-responsive" style="display:flex; gap:1.5rem; flex-wrap:wrap; align-items:flex-start;"><!-- Left: 3 component cards -->
     <div style="flex:1; min-width:260px; display:flex; flex-direction:column; gap:0.8rem;">
      <div class="surface-card" style="border-left:3px solid #ff6b6b;">
       <div style="display:flex; align-items:center; gap:0.6rem; margin-bottom:0.3rem;"><span class="tag-pill" style="background:rgba(255,107,107,0.2); color:#ff6b6b;">r</span> <strong>Distanza radiale</strong>
       </div>
       <p style="font-size:0.85rem; color:#94a3b8; line-height:1.5;">Distanza dall'origine al punto P. Sempre â‰¥ 0.</p>
      </div>
      <div class="surface-card" style="border-left:3px solid #4facfe;">
       <div style="display:flex; align-items:center; gap:0.6rem; margin-bottom:0.3rem;"><span class="tag-pill" style="background:rgba(79,172,254,0.2); color:#4facfe;">Î¸ (theta)</span> <strong>Angolo azimutale</strong>
       </div>
       <p style="font-size:0.85rem; color:#94a3b8; line-height:1.5;">Angolo dal verso positivo di <em>x</em> verso la proiezione di <strong>r</strong> nel piano <em>xy</em>. Intervallo: [0, 2Ï€).</p>
      </div>
      <div class="surface-card" style="border-left:3px solid #43e97b;">
       <div style="display:flex; align-items:center; gap:0.6rem; margin-bottom:0.3rem;"><span class="tag-pill" style="background:rgba(67,233,123,0.2); color:#43e97b;">Ï† (phi)</span> <strong>Angolo polare</strong>
       </div>
       <p style="font-size:0.85rem; color:#94a3b8; line-height:1.5;">Angolo rispetto all'asse z positivo. Intervallo: [0, Ï€].</p>
      </div>
     </div><!-- Right: 3D interactive canvas -->
     <div style="flex:1; min-width:300px; display:flex; flex-direction:column; align-items:center;">
      <canvas id="canvas3d" class="viz-canvas" width="420" height="340" style="width:100%; max-width:420px;"></canvas>
      <p style="font-size:0.75rem; color:#64748b; margin-top:0.4rem;">ğŸ–±ï¸ Trascina per ruotare â€” asse z verso l'alto</p>
     </div>
    </div>
   </section><!-- SLIDE 3: Formule di conversione -->
   <section class="slide" id="slide-2" aria-label="Formule di conversione">
    <h1 class="slide-title">Relazione con le Coordinate Cartesiane</h1>
    <div class="flex-responsive" style="display:flex; gap:1.5rem; flex-wrap:wrap; margin-top:0.5rem;">
     <div style="flex:1; min-width:280px;">
      <h2 class="section-title">Sferiche â†’ Cartesiane</h2>
      <div class="math-box"><span style="color:#e8eaf0;">x</span> = <span class="r-color">r</span> sin<span class="phi-color">Ï†</span> cos<span class="theta-color">Î¸</span>
      </div>
      <div class="math-box"><span style="color:#e8eaf0;">y</span> = <span class="r-color">r</span> sin<span class="phi-color">Ï†</span> sin<span class="theta-color">Î¸</span>
      </div>
      <div class="math-box"><span style="color:#e8eaf0;">z</span> = <span class="r-color">r</span> cos<span class="phi-color">Ï†</span>
      </div>
     </div>
     <div style="flex:1; min-width:280px;">
      <h2 class="section-title">Cartesiane â†’ Sferiche</h2>
      <div class="math-box"><span class="r-color">r</span> = âˆš(xÂ² + yÂ² + zÂ²)
      </div>
      <div class="math-box"><span class="theta-color">Î¸</span>: cos<span class="theta-color">Î¸</span> = x/Ï, sin<span class="theta-color">Î¸</span> = y/Ï
      </div>
      <div class="math-box"><span class="phi-color">Ï†</span> = arccos(z / <span class="r-color">r</span>)
      </div>
     </div>
    </div>
    <div class="surface-card" style="margin-top:1rem; border:1px solid rgba(79,140,255,0.25);">
     <p style="font-size:0.95rem; color:#cbd5e1; font-weight:600; margin-bottom:0.5rem;">ğŸ“ Come determinare il quadrante corretto di <span class="theta-color">Î¸</span></p>
     <p style="font-size:0.85rem; color:#94a3b8; line-height:1.7; margin-bottom:0.6rem;">
      La proiezione del vettore <strong>r</strong> sul piano <em>xy</em> ha modulo <strong style="color:#e8eaf0;">Ï = r sin Ï†</strong>. 
      L'angolo <span class="theta-color">Î¸</span> Ã¨ quello che questa proiezione forma con l'asse x positivo. 
      Per identificare il quadrante corretto si usano <em>entrambe</em> le componenti:
     </p>
     <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:0.5rem; margin-bottom:0.7rem;">
      <div class="math-box" style="margin:0;">cos <span class="theta-color">Î¸</span> = x / (r sin <span class="phi-color">Ï†</span>) = x / Ï</div>
      <div class="math-box" style="margin:0;">sin <span class="theta-color">Î¸</span> = y / (r sin <span class="phi-color">Ï†</span>) = y / Ï</div>
     </div>
     <p style="font-size:0.85rem; color:#94a3b8; line-height:1.7; margin-bottom:0.5rem;">
      Il segno di <em>cos Î¸</em> e <em>sin Î¸</em> indica il quadrante:
     </p>
     <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(170px,1fr)); gap:0.4rem; font-size:0.8rem;">
      <div style="background:rgba(79,140,255,0.08); border-radius:8px; padding:0.5rem 0.7rem; border:1px solid rgba(79,140,255,0.2);">
       <strong style="color:#4facfe;">I quadrante</strong><br>x &gt; 0, y &gt; 0<br><span style="color:#94a3b8;">cos Î¸ &gt; 0, sin Î¸ &gt; 0<br>Î¸ âˆˆ (0, Ï€/2)</span>
      </div>
      <div style="background:rgba(79,140,255,0.08); border-radius:8px; padding:0.5rem 0.7rem; border:1px solid rgba(79,140,255,0.2);">
       <strong style="color:#4facfe;">II quadrante</strong><br>x &lt; 0, y &gt; 0<br><span style="color:#94a3b8;">cos Î¸ &lt; 0, sin Î¸ &gt; 0<br>Î¸ âˆˆ (Ï€/2, Ï€)</span>
      </div>
      <div style="background:rgba(79,140,255,0.08); border-radius:8px; padding:0.5rem 0.7rem; border:1px solid rgba(79,140,255,0.2);">
       <strong style="color:#4facfe;">III quadrante</strong><br>x &lt; 0, y &lt; 0<br><span style="color:#94a3b8;">cos Î¸ &lt; 0, sin Î¸ &lt; 0<br>Î¸ âˆˆ (Ï€, 3Ï€/2)</span>
      </div>
      <div style="background:rgba(79,140,255,0.08); border-radius:8px; padding:0.5rem 0.7rem; border:1px solid rgba(79,140,255,0.2);">
       <strong style="color:#4facfe;">IV quadrante</strong><br>x &gt; 0, y &lt; 0<br><span style="color:#94a3b8;">cos Î¸ &gt; 0, sin Î¸ &lt; 0<br>Î¸ âˆˆ (3Ï€/2, 2Ï€)</span>
      </div>
     </div>
     <p style="font-size:0.8rem; color:#64748b; margin-top:0.6rem; line-height:1.5;">
      ğŸ’¡ <strong style="color:#94a3b8;">Procedura:</strong> calcola Ï = r sin Ï†, poi ricava cos Î¸ = x/Ï e sin Î¸ = y/Ï. I segni di entrambi determinano univocamente il quadrante, e quindi il valore esatto di Î¸ âˆˆ [0, 2Ï€).
     </p>
    </div>
   </section><!-- SLIDE 4: Applicazioni -->
   <section class="slide" id="slide-3" aria-label="Applicazioni">
    <h1 class="slide-title">Applicazioni Pratiche</h1>
    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px,1fr)); gap:1rem; margin-top:0.5rem;">
     <div class="surface-card">
      <div style="font-size:1.8rem; margin-bottom:0.5rem;">
       âš¡
      </div>
      <h2 class="section-title" style="font-size:1.1rem;">Fisica</h2>
      <p style="font-size:0.85rem; color:#94a3b8; line-height:1.6;">Campi elettrici e gravitazionali con simmetria sferica. Il potenziale coulombiano V = kq/<span class="r-color">r</span> si semplifica notevolmente.</p>
     </div>
     <div class="surface-card">
      <div style="font-size:1.8rem; margin-bottom:0.5rem;">
       ğŸ”­
      </div>
      <h2 class="section-title" style="font-size:1.1rem;">Astronomia</h2>
      <p style="font-size:0.85rem; color:#94a3b8; line-height:1.6;">Posizione dei corpi celesti: ascensione retta e declinazione sono coordinate sferiche sulla sfera celeste.</p>
     </div>
     <div class="surface-card">
      <div style="font-size:1.8rem; margin-bottom:0.5rem;">
       âˆ«âˆ«âˆ«
      </div>
      <h2 class="section-title" style="font-size:1.1rem;">Integrazione Tripla</h2>
      <p style="font-size:0.85rem; color:#94a3b8; line-height:1.6;">Lo Jacobiano <span class="r-color">rÂ²</span> sin<span class="phi-color">Ï†</span> semplifica il calcolo di volumi e momenti su regioni sferiche.</p>
      <div class="math-box" style="margin-top:0.6rem; font-size:0.85rem;">
       dV = <span class="r-color">rÂ²</span> sin<span class="phi-color">Ï†</span> d<span class="r-color">r</span> d<span class="theta-color">Î¸</span> d<span class="phi-color">Ï†</span>
      </div>
     </div>
    </div>
   </section><!-- SLIDE 6: Quiz -->
   <section class="slide" id="slide-4" aria-label="Quiz interattivo">
    <h1 class="slide-title">Momento Interattivo ğŸ§ </h1><!-- Quiz 1 -->
    <div id="quiz1" style="margin-bottom:1.2rem;">
     <h2 class="section-title" style="font-size:1rem;">Domanda 1: Un punto ha coordinate cartesiane P = (0, 0, 3). Quanto vale Ï†?</h2>
     <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:0.5rem;" id="quiz1Options"><button class="quiz-option" data-q="1" data-a="a">A) Ï† = Ï€/2</button> <button class="quiz-option" data-q="1" data-a="b">B) Ï† = Ï€</button> <button class="quiz-option" data-q="1" data-a="c">C) Ï† = 0</button> <button class="quiz-option" data-q="1" data-a="d">D) Ï† = Ï€/4</button>
     </div>
     <p id="quiz1Feedback" style="margin-top:0.4rem; font-size:0.85rem; min-height:1.2rem;"></p>
    </div><!-- Quiz 2 -->
    <div id="quiz2" style="margin-bottom:1.2rem;">
     <h2 class="section-title" style="font-size:1rem;">Domanda 2: Se P = (1, 1, âˆš2), quanto vale r?</h2>
     <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:0.5rem;" id="quiz2Options"><button class="quiz-option" data-q="2" data-a="a">A) âˆš2</button> <button class="quiz-option" data-q="2" data-a="b">B) 2</button> <button class="quiz-option" data-q="2" data-a="c">C) âˆš6</button> <button class="quiz-option" data-q="2" data-a="d">D) 4</button>
     </div>
     <p id="quiz2Feedback" style="margin-top:0.4rem; font-size:0.85rem; min-height:1.2rem;"></p>
    </div><!-- Esercizio guidato -->
    <div class="surface-card" style="border:1px solid rgba(79,140,255,0.25);">
     <h2 class="section-title" style="font-size:1rem;">Esercizio Guidato: Converti P = (1, âˆš3, 2) in sferiche</h2>
     <div style="display:flex; flex-wrap:wrap; gap:1rem; align-items:center; margin-top:0.5rem;">
      <div><label for="exR" style="font-size:0.8rem; color:#94a3b8;"><span class="r-color">r</span> =</label> <input id="exR" class="exercise-input" type="text" autocomplete="off">
      </div>
      <div><label for="exTheta" style="font-size:0.8rem; color:#94a3b8;"><span class="theta-color">Î¸</span> =</label> <input id="exTheta" class="exercise-input" type="text" autocomplete="off" placeholder="in rad">
      </div>
      <div><label for="exPhi" style="font-size:0.8rem; color:#94a3b8;"><span class="phi-color">Ï†</span> =</label> <input id="exPhi" class="exercise-input" type="text" autocomplete="off" placeholder="in rad">
      </div><button id="checkExBtn" class="nav-btn" style="background:var(--primary-color);">Verifica</button>
     </div>
     <p id="exFeedback" style="margin-top:0.5rem; font-size:0.85rem; min-height:1.2rem;"></p>
     <details style="margin-top:0.5rem;"><summary style="font-size:0.8rem; color:var(--primary-color); cursor:pointer;">Mostra soluzione</summary>
      <div style="font-size:0.85rem; color:#cbd5e1; margin-top:0.4rem; line-height:1.7;"><span class="r-color">r</span> = âˆš(1 + 3 + 4) = âˆš8 = 2âˆš2 â‰ˆ 2.83<br><span class="theta-color">Î¸</span>: Ï = r sin Ï† = 2âˆš2 Â· sin(Ï€/4) = 2âˆš2 Â· (âˆš2/2) = 2 â†’ cos Î¸ = x/Ï = 1/2 &gt; 0, sin Î¸ = y/Ï = âˆš3/2 &gt; 0 â†’ I quadrante â†’ Î¸ = arccos(1/2) = Ï€/3 â‰ˆ 1.047 rad<br><span class="phi-color">Ï†</span> = arccos(z/<span class="r-color">r</span>) = arccos(2/2âˆš2) = arccos(1/âˆš2) = Ï€/4 â‰ˆ 0.785 rad
      </div>
     </details>
    </div>
   </section><!-- SLIDE 7: Riepilogo -->
   <section class="slide" id="slide-5" aria-label="Riepilogo finale">
    <h1 class="slide-title">Riepilogo Finale</h1><!-- Concept map -->
    <div style="display:flex; flex-wrap:wrap; gap:0.8rem; justify-content:center; margin:0.8rem 0;">
     <div class="concept-node" style="border-color:#ff6b6b;"><span class="r-color">r</span> â€” Distanza
     </div>
     <div style="align-self:center; color:#64748b;">
      â†’
     </div>
     <div class="concept-node" style="border-color:var(--primary-color);">
      Punto P(<span class="r-color">r</span>,<span class="theta-color">Î¸</span>,<span class="phi-color">Ï†</span>)
     </div>
     <div style="align-self:center; color:#64748b;">
      â†
     </div>
     <div class="concept-node" style="border-color:#4facfe;"><span class="theta-color">Î¸</span> â€” Azimut
     </div>
     <div style="width:100%; text-align:center; color:#64748b; font-size:0.8rem;">
      â†•
     </div>
     <div class="concept-node" style="border-color:#43e97b;"><span class="phi-color">Ï†</span> â€” Polare
     </div>
     <div style="align-self:center; color:#64748b;">
      â‡Œ
     </div>
     <div class="concept-node">
      Cartesiane (x, y, z)
     </div>
     <div style="align-self:center; color:#64748b;">
      â‡Œ
     </div>
     <div class="concept-node">
      Cilindriche (Ï, Î¸, z)
     </div>
    </div><!-- Comparison table -->
    <h2 class="section-title" style="margin-top:1rem;">Confronto dei Sistemi di Coordinate</h2>
    <div style="overflow-x:auto;">
     <table class="comparison-table">
      <thead>
       <tr>
        <th></th>
        <th>Cartesiane</th>
        <th>Cilindriche</th>
        <th>Sferiche</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td style="font-weight:700; text-align:left;">Coordinate</td>
        <td>(x, y, z)</td>
        <td>(Ï, Î¸, z)</td>
        <td>(<span class="r-color">r</span>, <span class="theta-color">Î¸</span>, <span class="phi-color">Ï†</span>)</td>
       </tr>
       <tr>
        <td style="font-weight:700; text-align:left;">Simmetria naturale</td>
        <td>Rettangolare</td>
        <td>Assiale</td>
        <td>Sferica</td>
       </tr>
       <tr>
        <td style="font-weight:700; text-align:left;">Elemento di volume</td>
        <td>dx dy dz</td>
        <td>Ï dÏ dÎ¸ dz</td>
        <td><span class="r-color">rÂ²</span>sin<span class="phi-color">Ï†</span> d<span class="r-color">r</span>d<span class="theta-color">Î¸</span>d<span class="phi-color">Ï†</span></td>
       </tr>
       <tr>
        <td style="font-weight:700; text-align:left;">Uso tipico</td>
        <td>Geometria piana</td>
        <td>Tubi, fili</td>
        <td>Sfere, campi centrali</td>
       </tr>
      </tbody>
     </table>
    </div>
    <div style="text-align:center; margin-top:1.5rem; color:#64748b; font-size:0.9rem;">
     <p>ğŸ“ <em>Â«Le coordinate sferiche trasformano la complessitÃ  in simmetria.Â»</em></p>
    </div>
   </section><!-- NAVIGATION BAR -->
   <nav class="nav-bar" aria-label="Navigazione slide"><button class="nav-btn" id="prevBtn" disabled aria-label="Slide precedente">â—€ Indietro</button>
    <div class="progress-track" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="7">
     <div class="progress-fill" id="progressFill" style="width:16.66%"></div>
    </div><span id="slideCounter" style="font-size:0.8rem; color:#64748b; min-width:50px; text-align:center;">1 / 6</span> <button class="nav-btn" id="fullscreenBtn" aria-label="ModalitÃ  schermo intero" title="Premi per schermo intero">ğŸ–¥ï¸</button> <button class="nav-btn" id="pauseRotateBtn" aria-label="Pausa rotazione" title="Pausa rotazione assi" style="display:none;">â¸ï¸</button> <button class="nav-btn" id="nextBtn" aria-label="Slide successiva">Avanti â–¶</button>
   </nav>
  </main>
  <script>
let currentSlide = 0;
const totalSlides = 6;
const slides = document.querySelectorAll('.slide');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn');
const pauseRotateBtn = document.getElementById('pauseRotateBtn');
const progressFill = document.getElementById('progressFill');
const slideCounter = document.getElementById('slideCounter');
const appContainer = document.getElementById('app');
let isFullscreen = false;
let isRotationPaused = false;

function toggleFullscreen() {
  try {
    if (!document.fullscreenElement) {
      appContainer.requestFullscreen().catch(err => {
        console.warn('Fullscreen non disponibile:', err.message);
        isFullscreen = true;
        fullscreenBtn.innerHTML = 'âœ–ï¸';
        fullscreenBtn.setAttribute('aria-label', 'Esci da schermo intero');
      });
    } else {
      document.exitFullscreen();
    }
  } catch (err) {
    console.warn('Errore fullscreen:', err.message);
  }
}

function toggleRotationPause() {
  isRotationPaused = !isRotationPaused;
  if (isRotationPaused) {
    pauseRotateBtn.innerHTML = 'â–¶ï¸';
    pauseRotateBtn.setAttribute('aria-label', 'Riprendi rotazione');
  } else {
    pauseRotateBtn.innerHTML = 'â¸ï¸';
    pauseRotateBtn.setAttribute('aria-label', 'Pausa rotazione');
  }
}

fullscreenBtn.addEventListener('click', (e) => {
  e.preventDefault();
  toggleFullscreen();
});

pauseRotateBtn.addEventListener('click', (e) => {
  e.preventDefault();
  toggleRotationPause();
});

document.addEventListener('fullscreenchange', () => {
  if (document.fullscreenElement) {
    isFullscreen = true;
    fullscreenBtn.innerHTML = 'âœ–ï¸';
    fullscreenBtn.setAttribute('aria-label', 'Esci da schermo intero');
  } else {
    isFullscreen = false;
    fullscreenBtn.innerHTML = 'ğŸ–¥ï¸';
    fullscreenBtn.setAttribute('aria-label', 'ModalitÃ  schermo intero');
  }
});

document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && isFullscreen) {
    if (document.fullscreenElement) {
      document.exitFullscreen();
    }
  }
});

function goToSlide(idx) {
  if (idx < 0 || idx >= totalSlides) return;
  
  const oldSlide = currentSlide;
  slides[oldSlide].classList.remove('active');
  slides[oldSlide].classList.add('exit-left');
  
  setTimeout(() => {
    slides[oldSlide].classList.remove('exit-left');
  }, 600);

  currentSlide = idx;
  slides[currentSlide].classList.add('active');
  slides[currentSlide].scrollTop = 0;

  prevBtn.disabled = currentSlide === 0;
  nextBtn.disabled = currentSlide === totalSlides - 1;
  progressFill.style.width = `${((currentSlide + 1) / totalSlides) * 100}%`;
  slideCounter.textContent = `${currentSlide + 1} / ${totalSlides}`;

  // Mostra o nascondi il pulsante pausa in base alla slide
  if (currentSlide === 1) {
    pauseRotateBtn.style.display = 'block';
    isRotationPaused = false;
    pauseRotateBtn.innerHTML = 'â¸ï¸';
    pauseRotateBtn.setAttribute('aria-label', 'Pausa rotazione');
    setTimeout(() => draw3DScene(), 100);
  } else {
    pauseRotateBtn.style.display = 'none';
  }

}

prevBtn.addEventListener('click', () => {
  goToSlide(currentSlide - 1);
});

nextBtn.addEventListener('click', () => {
  goToSlide(currentSlide + 1);
});

document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowRight' || e.key === ' ') {
    e.preventDefault();
    goToSlide(currentSlide + 1);
  }
  if (e.key === 'ArrowLeft') {
    e.preventDefault();
    goToSlide(currentSlide - 1);
  }
});

// â”€â”€â”€ 3D Coordinate Visualization â”€â”€â”€
const canvas3d = document.getElementById('canvas3d');
const ctx3d = canvas3d.getContext('2d');
let rotX = -0.5, rotZ = 0.4;
let dragging = false, lastMX = 0, lastMY = 0;

canvas3d.addEventListener('mousedown', (e) => {
  dragging = true;
  lastMX = e.clientX;
  lastMY = e.clientY;
});

canvas3d.addEventListener('touchstart', (e) => {
  dragging = true;
  lastMX = e.touches[0].clientX;
  lastMY = e.touches[0].clientY;
}, { passive: true });

window.addEventListener('mouseup', () => {
  dragging = false;
});

window.addEventListener('touchend', () => {
  dragging = false;
});

window.addEventListener('mousemove', (e) => {
  if (!dragging) return;
  rotZ += (e.clientX - lastMX) * 0.008;
  rotX += (e.clientY - lastMY) * 0.008;
  rotX = Math.max(-1.2, Math.min(-0.1, rotX));
  lastMX = e.clientX;
  lastMY = e.clientY;
  draw3DScene();
});

window.addEventListener('touchmove', (e) => {
  if (!dragging) return;
  rotZ += (e.touches[0].clientX - lastMX) * 0.008;
  rotX += (e.touches[0].clientY - lastMY) * 0.008;
  rotX = Math.max(-1.2, Math.min(-0.1, rotX));
  lastMX = e.touches[0].clientX;
  lastMY = e.touches[0].clientY;
  draw3DScene();
}, { passive: true });

function project(x3, y3, z3) {
  let x1 = x3 * Math.cos(rotZ) - y3 * Math.sin(rotZ);
  let y1 = x3 * Math.sin(rotZ) + y3 * Math.cos(rotZ);
  let z1 = z3;
  let y2 = y1 * Math.cos(rotX) - z1 * Math.sin(rotX);
  let z2 = y1 * Math.sin(rotX) + z1 * Math.cos(rotX);
  let x2 = x1;
  const scale = 90;
  const cx = canvas3d.width / 2;
  const cy = canvas3d.height / 2;
  return [cx + x2 * scale, cy - z2 * scale, y2];
}

function drawLine3D(ctx, x1, y1, z1, x2, y2, z2, color, width = 1.5) {
  const [px1, py1] = project(x1, y1, z1);
  const [px2, py2] = project(x2, y2, z2);
  ctx.beginPath();
  ctx.moveTo(px1, py1);
  ctx.lineTo(px2, py2);
  ctx.strokeStyle = color;
  ctx.lineWidth = width;
  ctx.stroke();
}

function drawArrow3D(ctx, x1, y1, z1, x2, y2, z2, color, width = 1.5) {
  drawLine3D(ctx, x1, y1, z1, x2, y2, z2, color, width);
  
  const [px2, py2] = project(x2, y2, z2);
  const [px1, py1] = project(x1, y1, z1);
  
  const angle = Math.atan2(py2 - py1, px2 - px1);
  const arrowSize = 12;
  
  ctx.beginPath();
  ctx.moveTo(px2, py2);
  ctx.lineTo(px2 - arrowSize * Math.cos(angle - Math.PI / 6), py2 - arrowSize * Math.sin(angle - Math.PI / 6));
  ctx.moveTo(px2, py2);
  ctx.lineTo(px2 - arrowSize * Math.cos(angle + Math.PI / 6), py2 - arrowSize * Math.sin(angle + Math.PI / 6));
  ctx.strokeStyle = color;
  ctx.lineWidth = width;
  ctx.stroke();
}

function drawText3D(ctx, x, y, z, text, color, fontSize = 12) {
  const [px, py] = project(x, y, z);
  ctx.fillStyle = color;
  ctx.font = `bold ${fontSize}px 'Source Sans 3', sans-serif`;
  ctx.fillText(text, px + 4, py - 4);
}

function draw3DScene() {
  const w = canvas3d.width;
  const h = canvas3d.height;
  ctx3d.clearRect(0, 0, w, h);

  ctx3d.globalAlpha = 0.15;
  for (let i = -2; i <= 2; i++) {
    drawLine3D(ctx3d, i, -2, 0, i, 2, 0, '#4facfe', 0.5);
    drawLine3D(ctx3d, -2, i, 0, 2, i, 0, '#4facfe', 0.5);
  }
  ctx3d.globalAlpha = 1;

  // Assi con frecce - sistema destrorso: x Ã— y = z
  drawArrow3D(ctx3d, 0, -1.8, 0, 0, 1.8, 0, '#ff6b6b', 2);
  drawArrow3D(ctx3d, -1.8, 0, 0, 1.8, 0, 0, '#43e97b', 2);
  drawArrow3D(ctx3d, 0, 0, -0.3, 0, 0, 1.8, '#4facfe', 2);

  drawText3D(ctx3d, 0, 1.9, 0, 'x', '#ff6b6b', 14);
  drawText3D(ctx3d, 1.9, 0, 0, 'y', '#43e97b', 14);
  drawText3D(ctx3d, 0, 0, 1.9, 'z', '#4facfe', 14);

  // Punto P
  const r = 1.5, theta = Math.PI / 4, phi = Math.PI / 3;
  const px = r * Math.sin(phi) * Math.sin(theta);
  const py = r * Math.sin(phi) * Math.cos(theta);
  const pz = r * Math.cos(phi);

  const pxFloor = px, pyFloor = py;

  ctx3d.setLineDash([]);
  drawLine3D(ctx3d, 0, 0, 0, px, py, pz, '#ff6b6b', 2.5);

  ctx3d.setLineDash([4, 4]);
  drawLine3D(ctx3d, px, py, pz, pxFloor, pyFloor, 0, '#94a3b8', 1);
  drawLine3D(ctx3d, 0, 0, 0, pxFloor, pyFloor, 0, '#94a3b8', 1.2);
  ctx3d.setLineDash([]);

  // Arco theta: dal verso positivo di y (che Ã¨ il verso positivo di x nel nostro sistema) verso la proiezione
  ctx3d.beginPath();
  const arcR = 0.5;
  for (let a = 0; a <= theta; a += 0.05) {
    const [ax, ay] = project(arcR * Math.sin(a), arcR * Math.cos(a), 0);
    if (a === 0) ctx3d.moveTo(ax, ay);
    else ctx3d.lineTo(ax, ay);
  }
  ctx3d.strokeStyle = '#4facfe';
  ctx3d.lineWidth = 2;
  ctx3d.stroke();
  drawText3D(ctx3d, 0.55 * Math.sin(theta / 2), 0.55 * Math.cos(theta / 2), 0, 'Î¸', '#4facfe', 15);

  // Arco phi
  ctx3d.beginPath();
  const phiArcR = 0.55;
  for (let a = 0; a <= phi; a += 0.05) {
    const ax3 = phiArcR * Math.sin(a) * Math.sin(theta);
    const ay3 = phiArcR * Math.sin(a) * Math.cos(theta);
    const az3 = phiArcR * Math.cos(a);
    const [sx, sy] = project(ax3, ay3, az3);
    if (a === 0) ctx3d.moveTo(sx, sy);
    else ctx3d.lineTo(sx, sy);
  }
  ctx3d.strokeStyle = '#43e97b';
  ctx3d.lineWidth = 2;
  ctx3d.stroke();
  drawText3D(ctx3d, 0.25 * Math.sin(phi / 2) * Math.sin(theta), 0.25 * Math.sin(phi / 2) * Math.cos(theta), 0.6 * Math.cos(phi / 2), 'Ï†', '#43e97b', 15);

  // Punto P
  const [spx, spy] = project(px, py, pz);
  ctx3d.beginPath();
  ctx3d.arc(spx, spy, 6, 0, Math.PI * 2);
  ctx3d.fillStyle = '#fbbf24';
  ctx3d.fill();
  ctx3d.strokeStyle = '#0a0e1a';
  ctx3d.lineWidth = 2;
  ctx3d.stroke();
  drawText3D(ctx3d, px + 0.15, py + 0.1, pz + 0.1, 'P', '#fbbf24', 15);

  const midX = px / 2, midY = py / 2, midZ = pz / 2;
  drawText3D(ctx3d, midX + 0.12, midY + 0.12, midZ, 'r', '#ff6b6b', 15);
}

const quizAnswers = { 1: 'c', 2: 'b' };
const quizExplanations = {
  1: 'âœ… Corretto! P = (0, 0, 3) giace sull\'asse z positivo: r = 3, e Ï† = arccos(z/r) = arccos(3/3) = arccos(1) = 0. L\'asse z positivo corrisponde a Ï† = 0.',
  2: 'âœ… Corretto! r = âˆš(1Â² + 1Â² + (âˆš2)Â²) = âˆš(1+1+2) = âˆš4 = 2.'
};
const quizWrong = {
  1: 'âŒ Riprova! Usa Ï† = arccos(z/r). Prima calcola r = âˆš(0Â² + 0Â² + 3Â²) = 3, poi Ï† = arccos(3/3) = arccos(1) = ?',
  2: 'âŒ Riprova! Usa la formula r = âˆš(xÂ² + yÂ² + zÂ²) con x=1, y=1, z=âˆš2.'
};

document.querySelectorAll('.quiz-option').forEach(btn => {
  btn.addEventListener('click', function() {
    const q = this.dataset.q;
    const a = this.dataset.a;
    const container = document.getElementById(`quiz${q}Options`);
    const feedback = document.getElementById(`quiz${q}Feedback`);

    if (container.querySelector('.correct')) return;

    container.querySelectorAll('.quiz-option').forEach(b => b.classList.remove('wrong'));

    if (a === quizAnswers[q]) {
      this.classList.add('correct');
      feedback.innerHTML = quizExplanations[q];
      feedback.style.color = '#43e97b';
    } else {
      this.classList.add('wrong');
      feedback.innerHTML = quizWrong[q];
      feedback.style.color = '#ff6b6b';
    }
  });
});

document.getElementById('checkExBtn').addEventListener('click', (e) => {
  e.preventDefault();
  const rVal = parseFloat(document.getElementById('exR').value);
  const thetaVal = parseFloat(document.getElementById('exTheta').value);
  const phiVal = parseFloat(document.getElementById('exPhi').value);
  const fb = document.getElementById('exFeedback');

  const rCorrect = Math.abs(rVal - 2 * Math.SQRT2) < 0.15 || Math.abs(rVal - 2.83) < 0.1;
  const thetaCorrect = Math.abs(thetaVal - Math.PI / 3) < 0.1 || Math.abs(thetaVal - 1.047) < 0.08;
  const phiCorrect = Math.abs(phiVal - Math.PI / 4) < 0.1 || Math.abs(phiVal - 0.785) < 0.08;

  if (rCorrect && thetaCorrect && phiCorrect) {
    fb.innerHTML = 'ğŸ‰ <strong>Perfetto!</strong> Tutte le risposte sono corrette!';
    fb.style.color = '#43e97b';
  } else {
    let hints = [];
    if (!rCorrect) hints.push('<span class="r-color">r</span> non Ã¨ corretto (atteso â‰ˆ 2.83)');
    if (!thetaCorrect) hints.push('<span class="theta-color">Î¸</span> non Ã¨ corretto (atteso â‰ˆ 1.047)');
    if (!phiCorrect) hints.push('<span class="phi-color">Ï†</span> non Ã¨ corretto (atteso â‰ˆ 0.785)');
    fb.innerHTML = 'âš ï¸ ' + hints.join(', ') + '. Riprova!';
    fb.style.color = '#fbbf24';
  }
});

let autoRotateInterval = null;
function startAutoRotate() {
  if (autoRotateInterval) return;
  autoRotateInterval = setInterval(() => {
    if (currentSlide !== 1 || dragging || isRotationPaused) return;
    rotZ += 0.006;
    draw3DScene();
  }, 30);
}
startAutoRotate();

draw3DScene();
</script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ce48db8623ced5e',t:'MTc3MTE1NTg2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
